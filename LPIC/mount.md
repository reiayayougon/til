### マウント・アンマウント

現在マウントされているファイルシステムを確認するコマンド
```
mount
cat /proc/self/mounts
cat /etc/mtab
```

mountコマンドは、デバイスとマウント先どちらもしてしなかった(mountのみ実行した)場合は、現在マウントされているファイルシステム一覧が、/etc/mtabファイルの情報を元に表示される。
また、Linuxでは/procディレクトリの配下に様々なリソース情報が収められている。
/proc/self/mountsと/proc/mountsファイルにも現在マウントされているファイルシステムの情報が格納されている

umountコマンド アンマウントを行う

|オプション|説明|
|----|----|
|-a|/etc/mtabファイルに記載されているファイルシステムを全てアンマウント|
|-t|指定した種類のファイルシステムのみをアンマウント|

-at xfsオプションを指定すると、現在マウントされている(/etc/mtabファイルシステムに記述されている)
xfs形式のファイルシステムを全てアンマウントする

### パーミッション

chmodコマンド ファイルやディレクトリのパーミッションを変更する

-Rオプションを使用すると、指定したディレクトリ及びその配下にあるファイルのパーミッションを変更することができる

dirディレクトリ及びその配下にあるファイルのパーミッションを755に設定するコマンド
```
chmod -R u=rwx, go=rx dir
chmod -R u=rwx, go-w dir
chmod -R 755 dir
```

パーミッションの指定には数値か記号を用いる

記号

|対象|説明|
|u|所有者|
|g|所有グループ|
|o|その他ユーザ|
|a|全てのユーザ|
|操作|説明|
|+|権限を追加|
|-|権限を削除|
|=|権限を指定|
|権限|説明|
|r|読み取り権|
|w|書き込み権|
|x|実行権|
|s|SUIDまたはSGID|
|t|スッティキービット|

#### デフォルトパーミッションとumask値

新規に作成されるファイルやディレクトリのデフォルトのパーミッションは、システムで定められているパーミッションの初期値を基本とし、それをumask値で調整することで決定される
umask値は、システムのパーミッション初期値から、どの権限を削除するかを定義する設定
通常/etc/basshrcなどに設定されており、シェルの起動時にシステムのデフォルト値に戻る
umask値を~/.basgrcなどに設定することで、ユーザごとにも指定できる


プログラムfileをどのユーザが実行しても、プログラムを所有するグループの権限で実行させたい。
fileのパーミッションは755である。適切なコマンドは
```
chmod 2755 file
chmod g+s file
```

プログラムをどのユーザが実行しても、プログラムを所有するグループの権限で実行されるよにするためにはSGIDを設定する。
通常、プログラムが実行されると、そのプロセスは実行したユーザの権限で動作する。
しかしSGIDが設定されたプログラムの場合、プログラムは所有するグループの権限で動作する。
これにより複数のユーザが同じグループに所属している場合、それらのユーザが共有できる特定のファイルやリソースに簡単にアクセスできるようになる。
ディレクトリにSGIDを設定すると、そのディレクトリ内で新しく作成されるファイルやサブディレクトリも、親ディレクトリの所有するグループに設定される

設定方法は、chmodコマンドで通常のパーミッションの値に2000を加えた値を設定するか、グループにsという権限を追加


file.txtの所有グループのみをtestからstaffgroupに変更した時のコマンド
```
chown :staffgroup file.txt
chown staffgroup file.txt
chown .staffgroup file.txt
```

所有グループのみを変更するにはchownまたはchgrpコマンドを利用
ユーザが所属しているグループであれば、一般ユーザでも変更できる

/etc/fstabファイルでマウントオプションとしてdefaultsをした場合のオプション
```
async,auto,dev,exec,nouser,rw,suid
```
async 非同期で入出力を行う
auto mount -aコマンド実行時にマウント
exec バイナリの実行を許可
nouser 一般ユーザによるマウントを禁止
rw 読み書きを許可
suid SUIDとSGIDを有効化

SUID
ファイルに子もパーミッションが設定されると、そのプログラムを実行する際に、実行ユーザの権限ではなく、そのファイルを所有するユーザの権限で実行される。
通常は、ファイルを実行するとそのユーザの権限で実行されるが、SUIDがが設定されたファイルでは、ファイルを所有するユーザの権限で実行される

SGID
プログラムを実行する際に、実行ユーザのグループではなく、そのファイルを所有するグループの権限で実行される。
通常は、プログラムを実行すると実行ユーザのプライマリグループの権限で実行されるが、SGIDが設定されたファイルは、ファイルを所有するグループの権限で実行される。


